<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Connect Schools</title>
  <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />

  <!-- Font Awesome icons (free version)-->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.1.0/css/all.css" crossorigin="anonymous">

  <!-- Bootstrap CSS-->
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css">

  <!-- Core theme CSS (includes Bootstrap)-->
  <link rel="stylesheet" href="f_styles.css">

  <!-- jQuery library-->
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>


</head>



<body>


  <header class="masthead" style="background-image: url(images/connect_logo.jpg)">



  </header>




  <nav class="navbar navbar-expand-md bg-dark navbar-dark">
    <a class="navbar-brand" href="#">Discussion Forum</a>
    <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="collapsibleNavbar">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="/">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="#create">Create Thread</a>

        </li>
        <li class="nav-item">
          <a class="nav-link" href="#thread-list">Threads</a>
        </li>
        <li class="nav-item"></li>
        <button id="logout-button" class="btn btn-primary">Logout</button>
        </li>
      </ul>
    </div>
  </nav>


  <button onclick="topFunction()" id="myBtn" title="Go to top">Go to top</button>
  <div class="container mt-3">
    <div class="row">
      <div class="col-sm-12">
        <% if (user && user.isLoggedIn) { %>
          <h2>Welcome to the Discussion Forum, <%= user.email %>!</h2>


          <% } else { %>
            <h2>Welcome to the Discussion Forum!</h2>
            <% } %>
              <hr>
              <h4 id="create">Create Thread</h4>

              <form id="thread-form">
                <div class="form-group">
                  <label for="title">Title:</label>
                  <input type="text" class="form-control" id="title" placeholder="Enter title" name="title" required>
                </div>
                <div class="form-group">
                  <label for="content">Content:</label>
                  <textarea class="form-control" id="content" placeholder="Enter content" name="content"
                    required></textarea>
                </div>
                <button type="submit" id="subthread" class="btn btn-primary">Submit</button>
              </form>
              <!-- ... -->
              <hr>
              <h4>Threads</h4>
              <div id="thread-list">
                <div id="thread-content">
                  <% if (threads && threads.length> 0) { %>
                    <% for (let i=0; i < threads.length; i++) { %>
                      <div class="thread" style="<%= i >= 2 ? 'display: none;' : '' %>">
                        <h5>
                          <%= threads[i].title %>
                        </h5>
                        <p>
                          <%= threads[i].content %>
                        </p>
                        <p>Posted by: <%= threads[i].user_name %>
                        </p>
                        <p>Date: <%= threads[i].date.toLocaleDateString('en-GB', { year: 'numeric' , month: 'short' ,
                            day: 'numeric' }) %>
                        </p>
                      </div>
                      <% } %>
                        <button id="show-more-btn">Show More</button>
                        <button id="show-less-btn" style="display: none;">Show Less</button>
                        <% } else { %>
                          <p>No threads found.</p>
                          <% } %>
                </div>
              </div>


              <script>
                const threadContent = document.getElementById('thread-content');
                const threads = document.getElementsByClassName('thread');
                const showMoreBtn = document.getElementById('show-more-btn');
                const showLessBtn = document.getElementById('show-less-btn');
                const maxVisibleThreads = 2;
                let currentVisibleThreads = maxVisibleThreads;

                function showMoreThreads() {
                  for (let i = currentVisibleThreads; i < currentVisibleThreads + maxVisibleThreads; i++) {
                    if (threads[i]) {
                      threads[i].style.display = 'block';
                    }
                  }
                  currentVisibleThreads += maxVisibleThreads;
                  updateButtons();
                }

                function showLessThreads() {
                  for (let i = currentVisibleThreads - maxVisibleThreads; i < currentVisibleThreads; i++) {
                    if (threads[i]) {
                      threads[i].style.display = 'none';
                    }
                  }
                  currentVisibleThreads -= maxVisibleThreads;
                  updateButtons();
                }

                function updateButtons() {
                  showMoreBtn.style.display = currentVisibleThreads < threads.length ? 'inline' : 'none';
                  showLessBtn.style.display = currentVisibleThreads > maxVisibleThreads ? 'inline' : 'none';
                }

                showMoreBtn.addEventListener('click', showMoreThreads);
                showLessBtn.addEventListener('click', showLessThreads);

                updateButtons();
              </script>
              <!-- ... -->





              <footer class="text-center text-white" style="background-color: #f1f1f1;">
                <!-- Grid container -->
                <div class="container pt-4">
                  <!-- Section: Social media -->
                  <section class="mb-4">
                    <!-- Facebook -->
                    <a class="btn btn-link btn-floating btn-lg text-dark m-1"
                      href="https://www.facebook.com/connect.nursery?locale=en_GB" role="button"
                      data-mdb-ripple-color="dark"><i class="fab fa-facebook-f"></i></a>

                    <!-- Twitter -->
                    <a class="btn btn-link btn-floating btn-lg text-dark m-1" href="#!" role="button"
                      data-mdb-ripple-color="dark"><i class="fab fa-twitter"></i></a>



                    <!-- Instagram -->
                    <a class="btn btn-link btn-floating btn-lg text-dark m-1" href="#!" role="button"
                      data-mdb-ripple-color="dark"><i class="fab fa-instagram"></i></a>



                  </section>
                  <!-- Section: Social media -->
                </div>
                <!-- Grid container -->

                <!-- Copyright -->
                <footer>
                  <div class="text-center text-dark p-3" style="background-color: rgba(0, 0, 0, 0.2);">
                    Â©
                    <a class="text-dark" href="https://www.connectschoolsuganda.org">www.connectschoolsuganda.org</a>
                  </div>
                  <!-- Copyright -->
                </footer>


                <script src="forum.js"></script>





                <!-- 
<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script> -->
                <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js"
                  integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1"
                  crossorigin="anonymous"></script>
                <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js"
                  integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM"
                  crossorigin="anonymous"></script>
</body>

</html>